{"version":3,"sources":["../src/load-initial-props.js"],"names":["resolve","obj","__esModule","loadInitialProps","routes","path","ctx","initialPropsPromises","isMatchedComponent","find","route","match","component","getInitialProps","load","push","then","e","console","error","Promise","all","initialProps"],"mappings":";;;;;;;;;;;;;;;AAAA;;AAEA,SAASA,OAAT,CAAkBC,GAAlB,EAAuB;AACrB,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAG,WAA3B,GAAsCA,GAA7C;AACD;AAED;;;;;;;;SAMsBE,gB;;;;;;;+BAAf,iBAAiCC,MAAjC,EAAyCC,IAAzC,EAA+CC,GAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,YAAAA,oBADD,GACwB,EADxB;AAGCC,YAAAA,kBAHD,GAGsBJ,MAAM,CAACK,IAAP,CAAa,UAAAC,KAAK,EAAI;AAC/C,kBAAMC,KAAK,GAAG,+BAAWN,IAAX,EAAiBK,KAAjB,CAAd,CAD+C,CAE/C;;AACA,kBACEC,KAAK,IACLD,KAAK,CAACE,SADN,KAECF,KAAK,CAACE,SAAN,CAAgBC,eAAhB,IAAmCH,KAAK,CAACE,SAAN,CAAgBE,IAFpD,CADF,EAIE;AACA,oBAAMF,SAAS,GAAGF,KAAK,CAACE,SAAxB;AACAL,gBAAAA,oBAAoB,CAACQ,IAArB,CACEH,SAAS,CAACE,IAAV,GACIF,SAAS,CACNE,IADH,GAEGE,IAFH,CAES,UAAAJ,SAAS,EAAI;AAAA,iCACQZ,OAAO,CAAEY,SAAF,CADf;AAAA,sBACXC,eADW,YACXA,eADW;;AAElB,yBAAOA,eAAe,GAAGA,eAAe;AAAGF,oBAAAA,KAAK,EAALA;AAAH,qBAAaL,GAAb,EAAlB,GAAuC,EAA7D;AACD,iBALH,WAMU,UAAAW,CAAC,EAAI;AACXC,kBAAAA,OAAO,CAACC,KAAR,CAAeF,CAAf;AACD,iBARH,CADJ,GAUIL,SAAS,CAACC,eAAV;AAA4BF,kBAAAA,KAAK,EAALA;AAA5B,mBAAsCL,GAAtC,EAXN;AAaD;;AAED,qBAAO,CAAC,CAACK,KAAT;AACD,aAzB0B,CAHtB;AAAA,0BA+BIH,kBA/BJ;AAAA;AAAA,mBAgCkBY,OAAO,CAACC,GAAR,CAAad,oBAAb,CAhClB;;AAAA;AAAA,wCAgCsD,CAhCtD;AAAA;AA+BHI,cAAAA,KA/BG;AAgCHW,cAAAA,YAhCG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import {matchPath} from 'react-router-dom';\n\nfunction resolve (obj) {\n  return obj && obj.__esModule ? obj.default : obj;\n}\n\n/**\n * load page init props\n * @param {*} routes routes config\n * @param {*} path req path\n * @param {*} ctx the context passing to page getInitialProps function as param\n */\nexport async function loadInitialProps (routes, path, ctx) {\n  const initialPropsPromises = [];\n\n  const isMatchedComponent = routes.find (route => {\n    const match = matchPath (path, route);\n    //if matched, judge compoent and getInitialProps is existed\n    if (\n      match &&\n      route.component &&\n      (route.component.getInitialProps || route.component.load)\n    ) {\n      const component = route.component;\n      initialPropsPromises.push (\n        component.load\n          ? component\n              .load ()\n              .then (component => {\n                const {getInitialProps} = resolve (component);\n                return getInitialProps ? getInitialProps ({match, ...ctx}) : {};\n              })\n              .catch (e => {\n                console.error (e);\n              })\n          : component.getInitialProps ({match, ...ctx})\n      );\n    }\n\n    return !!match;\n  });\n\n  return {\n    match: isMatchedComponent,\n    initialProps: (await Promise.all (initialPropsPromises))[0],\n  };\n}\n"],"file":"load-initial-props.js"}