{"version":3,"sources":["../src/ensure-ready.js"],"names":["ensureReady","routes","pathname","Promise","all","map","route","match","window","location","component","load","undefined","document","data","eval","getElementById","textContent","resolve"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;AAEA;;;;SAIsBA,W;;;;;;;4BAAf,iBAA2BC,MAA3B,EAAmCC,QAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCC,OAAO,CAACC,GAAR,CACJH,MAAM,CAACI,GAAP,CAAW,UAAAC,KAAK,EAAI;AAClB,kBAAMC,KAAK,GAAG,+BAAUL,QAAQ,IAAIM,MAAM,CAACC,QAAP,CAAgBP,QAAtC,EAAgDI,KAAhD,CAAd;;AACA,kBAAIC,KAAK,IAAID,KAAT,IAAkBA,KAAK,CAACI,SAAxB,IAAqCJ,KAAK,CAACI,SAAN,CAAgBC,IAAzD,EAA+D;AAC7D,uBAAOL,KAAK,CAACI,SAAN,CAAgBC,IAAhB,EAAP;AACD;;AACD,qBAAOC,SAAP;AACD,aAND,CADI,CADD;;AAAA;AAYL,gBAAI,QAAOJ,MAAP,uDAAOA,MAAP,OAAkBI,SAAlB,IAA+B,CAAC,CAACC,QAArC,EAA+C;AAC7C;AACAC,cAAAA,IAAI,GAAGC,IAAI,YAAKF,QAAQ,CAACG,cAAT,CAAwB,kBAAxB,EAA4CC,WAAjD,OAAX;AACD;;AAfI,6CAgBEd,OAAO,CAACe,OAAR,CAAgBJ,IAAhB,CAhBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import { matchPath } from \"react-router-dom\";\r\nimport * as utils from \"./utils\";\r\n\r\n/**\r\n * This help us to get initial app state data,\r\n * and ensure async page component is loaded before rendering\r\n */\r\nexport async function ensureReady(routes, pathname) {\r\n  await Promise.all(\r\n    routes.map(route => {\r\n      const match = matchPath(pathname || window.location.pathname, route);\r\n      if (match && route && route.component && route.component.load) {\r\n        return route.component.load();\r\n      }\r\n      return undefined;\r\n    })\r\n  );\r\n\r\n  let data;\r\n  if (typeof window !== undefined && !!document) {\r\n    // deserialize state from 'serialize-javascript' format\r\n    data = eval(`(${document.getElementById(\"server-app-state\").textContent})`);\r\n  }\r\n  return Promise.resolve(data);\r\n}\r\n"],"file":"ensure-ready.js"}