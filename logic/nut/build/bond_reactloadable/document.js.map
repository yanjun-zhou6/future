{"version":3,"sources":["../../src/bond_reactloadable/document.js"],"names":["BoundReactLoadableDocument","props","helmet","assets","dynamicBundles","initialProps","htmlAttrs","htmlAttributes","toComponent","bodyAttrs","bodyAttributes","styles","filter","bundle","file","endsWith","scripts","title","meta","link","client","css","map","style","publicPath","js","script","dynamicAssets","renderPage","dynamicModules","Page","moduleName","push","page","PureComponent","NutRoot","NutData","__html"],"mappings":"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","sourcesContent":["import React, {PureComponent} from 'react';\nimport serialize from 'serialize-javascript';\nimport {getBundles} from 'react-loadable/webpack';\nimport Loadable from 'react-loadable';\n\n/**\n * bond react-loadable document component\n * used to create init page template\n */\nexport default class BoundReactLoadableDocument extends PureComponent {\n  static async getInitialProps({\n    assets,\n    dynamicAssets,\n    initialProps,\n    renderPage,\n  }) {\n    const dynamicModules = [];\n    const page = await renderPage (Page => {\n      return props => (\n        <Loadable.Capture\n          report={moduleName => dynamicModules.push (moduleName)}\n        >\n          <Page {...props} />\n        </Loadable.Capture>\n      );\n    });\n    const dynamicBundles = getBundles (dynamicAssets, dynamicModules);\n    return {assets, initialProps, dynamicBundles, ...page};\n  }\n\n  render () {\n    const {helmet, assets, dynamicBundles, initialProps} = this.props;\n    // get attributes from React Helmet\n    const htmlAttrs = helmet.htmlAttributes.toComponent ();\n    const bodyAttrs = helmet.bodyAttributes.toComponent ();\n\n    let styles = dynamicBundles.filter (bundle =>\n      bundle.file.endsWith ('.css')\n    );\n    let scripts = dynamicBundles.filter (bundle =>\n      bundle.file.endsWith ('.js')\n    );\n    return (\n      <html {...htmlAttrs}>\n        <head>\n          <meta httpEquiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n          <meta charSet=\"utf-8\" />\n          <title>Welcome to Nut</title>\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n          {helmet.title.toComponent ()}\n          {helmet.meta.toComponent ()}\n          {helmet.link.toComponent ()}\n          {assets.client.css &&\n            <link rel=\"stylesheet\" href={assets.client.css} />}\n          {styles.map (style => (\n            <link rel=\"stylesheet\" href={style.publicPath} />\n          ))}\n          <link rel=\"preload\" as=\"script\" href={assets.client.js} />\n          {scripts.map (script => (\n            <link rel=\"preload\" as=\"script\" href={script.publicPath} />\n          ))}\n        </head>\n        <body {...bodyAttrs}>\n          <NutRoot />\n          <NutData initialProps={initialProps} />\n          <script src={assets.client.js} type=\"text/javascript\" />\n          {scripts.map (script => (\n            <script src={script.publicPath} type=\"text/javascript\" />\n          ))}\n          <script>{`window.main();`}</script>\n          {helmet.script.toComponent ()}\n        </body>\n      </html>\n    );\n  }\n}\n\nexport function NutRoot () {\n  return <div id=\"root\">DO_NOT_DELETE_THIS_YOU_WILL_BREAK_YOUR_APP</div>;\n}\n\nexport function NutData({initialProps}) {\n  return (\n    <script\n      id=\"server-app-state\"\n      type=\"application/json\"\n      dangerouslySetInnerHTML={{\n        __html: serialize ({...initialProps}),\n      }}\n    />\n  );\n}\n"],"file":"document.js"}