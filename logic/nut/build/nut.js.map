{"version":3,"sources":["../src/nut.js"],"names":["NutPartial","props","state","initialProps","previousLocation","nextProps","navigated","location","window","scrollTo","setState","undefined","match","routes","history","staticContext","rest","pathname","then","catch","e","map","route","i","path","exact","strict","React","createElement","component","PureComponent","Nut"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA;;;;;;;;IAQMA,U;;;;;AACJ,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA;AACjB,gHAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,YAAY,EAAEF,KAAK,CAACE,YADT;AAEXC,MAAAA,gBAAgB,EAAE;AAFP,KAAb;AAFiB;AAMlB,G,CAED;;;;;8CAC0BC,S,EAAW;AAAA;;AACnC,UAAMC,SAAS,GAAGD,SAAS,CAACE,QAAV,KAAuB,KAAKN,KAAL,CAAWM,QAApD;;AACA,UAAID,SAAJ,EAAe;AACbE,QAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB,EADa,CAEb;;AACA,aAAKC,QAAL,CAAc;AACZN,UAAAA,gBAAgB,EAAE,KAAKH,KAAL,CAAWM,QADjB;AAEZJ,UAAAA,YAAY,EAAEQ;AAFF,SAAd;AAHa,YASXR,YATW,GAgBTE,SAhBS,CASXF,YATW;AAAA,YAUXS,KAVW,GAgBTP,SAhBS,CAUXO,KAVW;AAAA,YAWXC,MAXW,GAgBTR,SAhBS,CAWXQ,MAXW;AAAA,YAYXC,OAZW,GAgBTT,SAhBS,CAYXS,OAZW;AAAA,YAaXP,QAbW,GAgBTF,SAhBS,CAaXE,QAbW;AAAA,YAcXQ,aAdW,GAgBTV,SAhBS,CAcXU,aAdW;AAAA,YAeRC,IAfQ,0CAgBTX,SAhBS;AAkBb,gDAAiB,KAAKJ,KAAL,CAAWY,MAA5B,EAAoCN,QAAQ,CAACU,QAA7C;AACEV,UAAAA,QAAQ,EAAEF,SAAS,CAACE,QADtB;AAEEO,UAAAA,OAAO,EAAET,SAAS,CAACS;AAFrB,WAGKE,IAHL,GAKGE,IALH,CAKQ,gBAAsB;AAAA,cAAnBf,YAAmB,QAAnBA,YAAmB;;AAC1B,UAAA,MAAI,CAACO,QAAL,CAAc;AAAEN,YAAAA,gBAAgB,EAAE,IAApB;AAA0BD,YAAAA,YAAY,EAAZA;AAA1B,WAAd;AACD,SAPH,EAQGgB,KARH,CAQS,UAAAC,CAAC,EAAI,CAGX,CAXH;AAYD;AACF;;;6BAEQ;AAAA,wBACoC,KAAKlB,KADzC;AAAA,UACCE,gBADD,eACCA,gBADD;AAAA,UACmBD,YADnB,eACmBA,YADnB;AAAA,wBAEoB,KAAKF,KAFzB;AAAA,UAEDM,QAFC,eAEDA,QAFC;AAAA,UAESM,MAFT,eAESA,MAFT;AAGP,aACE,6BAAC,sBAAD,QACGA,MAAM,CAACQ,GAAP,CAAW,UAACC,KAAD,EAAQC,CAAR;AAAA,eACV,6BAAC,qBAAD;AACE,UAAA,GAAG,mBAAYA,CAAZ,CADL;AAEE,UAAA,IAAI,EAAED,KAAK,CAACE,IAFd;AAGE,UAAA,KAAK,EAAEF,KAAK,CAACG,KAHf;AAIE,UAAA,MAAM,EAAEH,KAAK,CAACI,MAJhB;AAKE,UAAA,QAAQ,EAAEtB,gBAAgB,IAAIG,QALhC;AAME,UAAA,MAAM,EAAE,gBAAAN,KAAK;AAAA,mBACX0B,eAAMC,aAAN,CAAoBN,KAAK,CAACO,SAA1B,kCACK1B,YADL;AAEEW,cAAAA,OAAO,EAAEb,KAAK,CAACa,OAFjB;AAGEP,cAAAA,QAAQ,EAAEH,gBAAgB,IAAIG,QAHhC;AAIEK,cAAAA,KAAK,EAAEX,KAAK,CAACW;AAJf,eADW;AAAA;AANf,UADU;AAAA,OAAX,CADH,CADF;AAqBD;;;EArEsBkB,oB;;AAwElB,IAAMC,GAAG,GAAG,gCAAW/B,UAAX,CAAZ","sourcesContent":["import React, { PureComponent } from \"react\";\r\nimport { Switch, Route, withRouter } from \"react-router-dom\";\r\nimport { loadInitialProps } from \"./load-initial-props\";\r\n\r\n/**\r\n * Find page component based url path,\r\n * and initial component props.\r\n *\r\n * Used by client and sever.\r\n * on client, require finding page component and geting initial props,\r\n * but not on sever, initial props as parameter come in.\r\n */\r\nclass NutPartial extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      initialProps: props.initialProps,\r\n      previousLocation: null\r\n    };\r\n  }\r\n\r\n  // only runs client\r\n  componentWillReceiveProps(nextProps) {\r\n    const navigated = nextProps.location !== this.props.location;\r\n    if (navigated) {\r\n      window.scrollTo(0, 0);\r\n      // save the location so we can render the old screen\r\n      this.setState({\r\n        previousLocation: this.props.location,\r\n        initialProps: undefined\r\n      });\r\n\r\n      let {\r\n        initialProps,\r\n        match,\r\n        routes,\r\n        history,\r\n        location,\r\n        staticContext,\r\n        ...rest\r\n      } = nextProps;\r\n\r\n      loadInitialProps(this.props.routes, location.pathname, {\r\n        location: nextProps.location,\r\n        history: nextProps.history,\r\n        ...rest\r\n      })\r\n        .then(({ initialProps }) => {\r\n          this.setState({ previousLocation: null, initialProps });\r\n        })\r\n        .catch(e => {\r\n          // @todo we should more cleverly handle errors\r\n          console.log(e);\r\n        });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { previousLocation, initialProps } = this.state;\r\n    let { location, routes } = this.props;\r\n    return (\r\n      <Switch>\r\n        {routes.map((route, i) => (\r\n          <Route\r\n            key={`route--${i}`}\r\n            path={route.path}\r\n            exact={route.exact}\r\n            strict={route.strict}\r\n            location={previousLocation || location}\r\n            render={props =>\r\n              React.createElement(route.component, {\r\n                ...initialProps,\r\n                history: props.history,\r\n                location: previousLocation || location,\r\n                match: props.match\r\n              })\r\n            }\r\n          />\r\n        ))}\r\n      </Switch>\r\n    );\r\n  }\r\n}\r\n\r\nexport const Nut = withRouter(NutPartial);\r\n"],"file":"nut.js"}