{"version":3,"sources":["../src/nut.js"],"names":["NutPartial","props","state","initialProps","previousLocation","nextProps","navigated","location","window","scrollTo","setState","undefined","match","routes","history","staticContext","rest","pathname","then","e","console","log","map","route","i","path","exact","strict","React","createElement","component","PureComponent","Nut"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA;;;;;;;;IAQMA,U;;;;;AACJ,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA;AACjB,sHAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,YAAY,EAAEF,KAAK,CAACE,YADT;AAEXC,MAAAA,gBAAgB,EAAE;AAFP,KAAb;AAFiB;AAMlB,G,CAED;;;;;8CAC0BC,S,EAAW;AAAA;;AACnC,UAAMC,SAAS,GAAGD,SAAS,CAACE,QAAV,KAAuB,KAAKN,KAAL,CAAWM,QAApD;;AACA,UAAID,SAAJ,EAAe;AACbE,QAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB,EADa,CAEb;;AACA,aAAKC,QAAL,CAAc;AACZN,UAAAA,gBAAgB,EAAE,KAAKH,KAAL,CAAWM,QADjB;AAEZJ,UAAAA,YAAY,EAAEQ;AAFF,SAAd;AAHa,YASXR,YATW,GAgBTE,SAhBS,CASXF,YATW;AAAA,YAUXS,KAVW,GAgBTP,SAhBS,CAUXO,KAVW;AAAA,YAWXC,MAXW,GAgBTR,SAhBS,CAWXQ,MAXW;AAAA,YAYXC,OAZW,GAgBTT,SAhBS,CAYXS,OAZW;AAAA,YAaXP,QAbW,GAgBTF,SAhBS,CAaXE,QAbW;AAAA,YAcXQ,aAdW,GAgBTV,SAhBS,CAcXU,aAdW;AAAA,YAeRC,IAfQ,6CAgBTX,SAhBS;AAkBb,gDAAiB,KAAKJ,KAAL,CAAWY,MAA5B,EAAoCN,QAAQ,CAACU,QAA7C;AACEV,UAAAA,QAAQ,EAAEF,SAAS,CAACE,QADtB;AAEEO,UAAAA,OAAO,EAAET,SAAS,CAACS;AAFrB,WAGKE,IAHL,GAKGE,IALH,CAKQ,gBAAsB;AAAA,cAAnBf,YAAmB,QAAnBA,YAAmB;;AAC1B,UAAA,MAAI,CAACO,QAAL,CAAc;AAAEN,YAAAA,gBAAgB,EAAE,IAApB;AAA0BD,YAAAA,YAAY,EAAZA;AAA1B,WAAd;AACD,SAPH,WAQS,UAAAgB,CAAC,EAAI;AACV;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD,SAXH;AAYD;AACF;;;6BAEQ;AAAA,wBACoC,KAAKjB,KADzC;AAAA,UACCE,gBADD,eACCA,gBADD;AAAA,UACmBD,YADnB,eACmBA,YADnB;AAAA,wBAEoB,KAAKF,KAFzB;AAAA,UAEDM,QAFC,eAEDA,QAFC;AAAA,UAESM,MAFT,eAESA,MAFT;AAGP,aACE,gCAAC,sBAAD,QACGA,MAAM,CAACS,GAAP,CAAW,UAACC,KAAD,EAAQC,CAAR;AAAA,eACV,gCAAC,qBAAD;AACE,UAAA,GAAG,mBAAYA,CAAZ,CADL;AAEE,UAAA,IAAI,EAAED,KAAK,CAACE,IAFd;AAGE,UAAA,KAAK,EAAEF,KAAK,CAACG,KAHf;AAIE,UAAA,MAAM,EAAEH,KAAK,CAACI,MAJhB;AAKE,UAAA,QAAQ,EAAEvB,gBAAgB,IAAIG,QALhC;AAME,UAAA,MAAM,EAAE,gBAAAN,KAAK;AAAA,mBACX2B,kBAAMC,aAAN,CAAoBN,KAAK,CAACO,SAA1B,qCACK3B,YADL;AAEEW,cAAAA,OAAO,EAAEb,KAAK,CAACa,OAFjB;AAGEP,cAAAA,QAAQ,EAAEH,gBAAgB,IAAIG,QAHhC;AAIEK,cAAAA,KAAK,EAAEX,KAAK,CAACW;AAJf,eADW;AAAA;AANf,UADU;AAAA,OAAX,CADH,CADF;AAqBD;;;EArEsBmB,oB;;AAwElB,IAAMC,GAAG,GAAG,gCAAWhC,UAAX,CAAZ","sourcesContent":["import React, { PureComponent } from \"react\";\nimport { Switch, Route, withRouter } from \"react-router-dom\";\nimport { loadInitialProps } from \"./load-initial-props\";\n\n/**\n * Find page component based url path,\n * and initial component props.\n *\n * Used by client and sever.\n * on client, require finding page component and geting initial props,\n * but not on sever, initial props as parameter come in.\n */\nclass NutPartial extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      initialProps: props.initialProps,\n      previousLocation: null\n    };\n  }\n\n  // only runs client\n  componentWillReceiveProps(nextProps) {\n    const navigated = nextProps.location !== this.props.location;\n    if (navigated) {\n      window.scrollTo(0, 0);\n      // save the location so we can render the old screen\n      this.setState({\n        previousLocation: this.props.location,\n        initialProps: undefined\n      });\n\n      let {\n        initialProps,\n        match,\n        routes,\n        history,\n        location,\n        staticContext,\n        ...rest\n      } = nextProps;\n\n      loadInitialProps(this.props.routes, location.pathname, {\n        location: nextProps.location,\n        history: nextProps.history,\n        ...rest\n      })\n        .then(({ initialProps }) => {\n          this.setState({ previousLocation: null, initialProps });\n        })\n        .catch(e => {\n          // @todo we should more cleverly handle errors\n          console.log(e);\n        });\n    }\n  }\n\n  render() {\n    const { previousLocation, initialProps } = this.state;\n    let { location, routes } = this.props;\n    return (\n      <Switch>\n        {routes.map((route, i) => (\n          <Route\n            key={`route--${i}`}\n            path={route.path}\n            exact={route.exact}\n            strict={route.strict}\n            location={previousLocation || location}\n            render={props =>\n              React.createElement(route.component, {\n                ...initialProps,\n                history: props.history,\n                location: previousLocation || location,\n                match: props.match\n              })\n            }\n          />\n        ))}\n      </Switch>\n    );\n  }\n}\n\nexport const Nut = withRouter(NutPartial);\n"],"file":"nut.js"}